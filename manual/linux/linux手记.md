# Linux 手记

## bash与shell

## 权限与目录

## 磁盘与文件系统

### 磁盘

#### 插槽与目录名

IDE磁盘目录名与插槽相关
| IDE\Jumper      | Master     | Slave      |
| --------------- | ---------- | ---------- |
| IDE1(Primary)   | `/dev/hda` | `/dev/hdb` |
| IDE2(Secondary) | `/dev/hdc` | `/dev/hdd` |

SATA磁盘/U盘/其他SCSI磁盘的目录名与检测顺序相关, 与插槽代号无关, 其格式为 `/dev/sd[a-p]`

#### 磁盘划分

* MBR (Master Boot Record): 主引导记录, 用于安装启动管理程序, `446bytes`
* partition table: 分区表, 用于记录整个磁盘分区状态, `64bytes`

关于主引导记录:

1. `boot loader` 是安装在 MBR 上读取核心内容运行的软件
2. `boot loader` 可以将启动管理功能转交给其他分区内的 `loader`
3. 其他分区内的 `loader` 安装在各自分区的 `启动磁区(boot sector)` 中

关于分区:

1. 对分区表的配置就是对磁盘进行分区
2. 分区表只能记录4条分区记录, `主要(Primary)` 或 `扩展(Extended)`, 注意: `主要分区 + 扩展分区 = 4`, 且 `扩展分区` 做多只能有1个
3. 分区的最小单位是 `柱面(cylinder)`
4. 系统必须参考分区表才能对分区进行数据处理

> 扩展分区并非实际的分区, 只存储一个扩展分区的分区数据, 其中包含若干个逻辑分区的信息

关于 `逻辑分区(logical partition)`:

1. 通过利用扩展分配可以增加逻辑分区
2. IDE中最多59个逻辑分区(5-63), SATA中最多11个逻辑分区(5-15)

#### 分区与挂载

### 文件系统

通过 `LVM` 或者 `软件磁盘阵列` 可以一个将一个分区格式化为多个文件系统, 或者将多个分区合成为一个文件系统, 所以我们通常将可挂载的数据称为一个 `可挂载的文件系统` 而不是分区

* `superblock`: 记录所在文件系统的整体信息,包括 `inode` 与 `block`的总量, 使用量, 剩余量, 以及文件系统的相关格式等信息
* `inode`: 记录文件的属性, 每个文件只占用一个 `inode`, 因此能够创建文件的数量与`inode` 的数量相关, 同时记录文件所在的 `block` 号码
* `block`: 实际记录文件的内容, 一个文件可能会占用多个 `block`

关于 `data block`:

* block 大小有1k, 2k, 4k并且在格式化时就已经固定
* 每个block只能存放一个文件的数据
* 如果数据量小于一个block的大小则多出的容量不能被其他文件所使用

关于 `inode`:

`inode` 所包含的文件数据有:

* 文件的存取模式(read/write/excute)
* 文件的拥有者和群组(owner/group)
* 文件的容量
* 文件的创建和改变的时间(ctime)
* 最近一次读取的时间(atime)
* 最近一次修改的时间(mtime)
* 定义文件特性的flag
* 文件block内容的指向(pointer)

`inode` 的一些特性:

* 每个 `inode` 的大小固定为 `128bytes`
* 系统读取文件时需要先读取 `inode` 然后才能判断权限与用户是否符合, 并实际开始读取 `block` 中的文件内容
