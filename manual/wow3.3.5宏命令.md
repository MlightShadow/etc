# WOW3.3.5 宏命令教程

参考资料:

* [World of Warcraft Wiki 宏完全指南](https://wowwiki.fandom.com/zh/wiki/%E5%AE%8F%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97?variant=zh-hans)
* [魔兽世界宏命令原理基础教学](http://www.nfuwow.com/simple/detail/artid/1744.html)
* [宏命令爱好者研究帖：宏的书写法则及优化](http://wow.178.com/201411/209771878915.html)
* [百度百科-宏](https://baike.baidu.com/item/%E5%AE%8F/2648286)

暴雪官方没有给出对于宏命令的具体指南, 至少我是没有看到过. 所以收集编纂网上的相关教程, 并加以实验汇聚成本文. 本文旨在能够帮助大家快速了解关于WOW3.3.5宏命令的原理及用法, 使大家可以通过宏命令完成个人需求, 简化游戏操作.

**注**:

1. 本文部分术语内容为网络流传, 若与其他文章不同请稍加理解其指代含义, 无需争论
2. 宏不能实现所有的游戏操作, 无法替代部分人工操作, 且有字数及个数限制, 无法完成过于复杂的工作

## 目录

[toc]

## 概述

### 什么是宏

我们从计算机方面来看宏的定义也是一个相对比较抽象的概念, 一般来说我们把一系列预先编写好的可以完成某种任务的语句称作宏, 其实我们也可以使用脚本一词来形容这个过程, 不过暴雪给出的 `Macro` 对应译作 `宏` 而不是 `script` 即 `脚本` 一词.

### 如何制作宏命令

打开宏命令界面最简单的方法即: 在聊天界面中输入`/macro` (`/m`)回车

![图片](todo)

![图片](todo)

![图片](todo)

### 一个简单的宏命令

这是一个简单的上马喊话宏, 使用上一节的知识, 将这段话添加到宏命令管理中, 那么你就得到了一个非常简单的宏命令

```macro
/cast 迅捷吉安娜缰绳
/say [outdoors] 上马不喊话, 三开战猎萨
```

我们可以简单的分析下这个宏命令, `/cast` 和 `/say` 都是动作指令, 用于让角色执行相应的动作, 而 `[outdoors]` 则为相应动作执行的 `命令条件语`, 如果条件判定为否则不执行相应的动作, 所以在这里我们在门外执行这个宏就会召唤坐骑并且喊话, 而在室内执行该宏, 由于条件的存在不会进行喊话, 同时因为游戏机制我们也无法召唤坐骑

所以有一些相关经验的小伙伴就能够发现, 我们使用宏命令就是通过一些动作语句和相应的参数设置, 使我们的操作变得更加简易和智能, 并且能给游戏带来一些额外的乐趣.

### 中文指令

有的小伙伴肯定发现了, `/施放` 与 `/cast` 都能够施放召唤坐骑, 在中文客户端中确实可以使用中文进行书写宏命令, 但是我们建议还是使用英文来书写, 当然方便查询技能的情况下中文客户端的用户可以按住`shift`点击对应技能来复制技能名称到宏命令管理器免去大家输入之苦

## 指令

经过上一章的学习, 你已经创建了一个简单的宏命令, 或者你已经通过一些宏命令收集整理的网站copy了一些宏命令供自己使用, 如果这已经满足了你的需求, 那么你大可以现在就关闭这篇文档, 但如果你的需求依然没有满足, 也许你可以尝试通过这一章的学习找到解决问题的办法.

### 直接动作指令

无法添加执行相应内容(技能或者物品等)的指令我们称之为`直接动作指令`

我们这里给出已经收集到直接动作指令及其作用

| 指令            | 作用                 |
| --------------- | -------------------- |
| `/startattack`  | 开始攻击             |
| `/stopattack`   | 停止攻击             |
| `/stopcasting`  | 停止施放             |
| `/stopmacro`    | 停止喊话             |
| `/assist`       | 协助                 |
| `/focus`        | 设置焦点目标         |
| `/clearfocus`   | 清除焦点目标         |
| `/cleartarget`  | 清除目标             |
| `/petattack`    | 宠物攻击             |
| `/petfollow`    | 宠物跟随             |
| `/petstay`      | 宠物原地停留         |
| `/petpassive`   | 宠物被动姿态         |
| `/petdefensive` | 宠物防御姿态         |
| `/petagressive` | 宠物主动姿态         |
| `/dismount`     | 下马                 |
| `/target`       | 选择你当前目标的目标 |

### 条件动作指令

可以添加执行相应内容(技能或者物品等)的指令我们称之为`条件动作指令`

| 指令               | 作用               |
| ------------------ | ------------------ |
| `/cast`            | 施放               |
| `/castrandom`      | 随机施放           |
| `/castsequence`    | 顺序施放           |
| `/cancelaura`      | 取消BUFF           |
| `/cancelform`      | 取消姿态           |
| `/equip`           | 装备               |
| `/equipslot`       | 装备到指定位置     |
| `/use`             | 使用               |
| `/userandom`       | 随机使用           |
| `/changeactionbar` | 切换动作条         |
| `/swapactionbar`   | 顺序切换动作条     |
| `/petautocaston`   | 宠物自动施放技能开 |
| `/petautocastoff`  | 宠物自动施放技能关 |
| `/click`           | 点击               |

### 辅助指令

辅助指令指帮助书写宏命令语句, 但对命令没有直接效果的部分命令
| 指令           | 作用                                                  |
| -------------- | ----------------------------------------------------- |
| `#show`        | 显示何种图标                                          |
| `#showtooltip` | 图标上的文字说明                                      |
| `#item`        | 在部分资料上查到了这个,具体不知道做什么用, **待测试** |

### 命令条件语

| 指令                        | 作用                         |
| --------------------------- | ---------------------------- |
| `help`                      | 目标可以接受增益法术         |
| `harm`                      | 目标可以受到攻击             |
| `exists`                    | 目标存在                     |
| `dead`                      | 目标已经挂了                 |
| `stance:0/1/2../n`          | 玩家在某姿态下               |
| `stealth`                   | 玩家在潜行状态下             |
| `modifier:shift/ctrl/alt`   | 某功能键被按下               |
| `button:1/…/5/<虚拟按键号>` | 宏通过某键点击执行           |
| `equipped:<装备类型>`       | 玩家装备了某类型物品         |
| `channeling:<法术名称>`     | 玩家正在引导某法术           |
| `actionbar:1/…./6`          | 当前技能栏为某动作栏         |
| `pet:<宠物名称或类型>`      | 玩家当前宠物为某宠物         |
| `combat`                    | 玩家正在战斗状态             |
| `mounted`                   | 玩家在骑乘状态               |
| `swimming`                  | 玩家在游泳                   |
| `flying`                    | 玩家在飞行状态               |
| `flyable`                   | 玩家正处在一个允许飞行的地界 |
| `indoors`                   | 玩家在室内                   |
| `outdoors`                  | 玩家在户外                   |
| `party`                     | 目标在玩家的小队中           |
| `raid`                      | 目标在玩家的小队或团队中     |
| `group:party/raid`          | 玩家在某集体中（小队/团队）  |

[姿态编号一览](#姿态编号一览)

## 进阶

### 阻塞宏

### 宏命令组合

## 附录

### 姿态编号一览

| 编号 | 小德        | 战士     | 暗牧     | 盗贼 | 萨满   | 死亡骑士 |
| ---- | ----------- | -------- | -------- | ---- | ------ | -------- |
| `1`  | 熊形态      | 战斗姿态 | 暗影形态 | 潜行 | 幽灵狼 | 鲜血     |
| `2`  | 海豹形态    | 防御姿态 |          |      |        | 冰霜     |
| `3`  | 豹形态      | 狂暴姿态 |          |      |        | 邪恶     |
| `4`  | 旅行形态    |          |          |      |        |          |
| `5`  | 枭兽/树形态 |          |          |      |        |          |
| `6`  | 飞行形态    |          |          |      |        |          |

### 功能键变量

| 变量名             | 功能           |
| ------------------ | -------------- |
| `SELFCAST`         | 自我施法       |
| `AUTOLOOTTOGGLE`   | 自动拾取键     |
| `STICKYCAMERRA`    | 镜头跟随       |
| `SPLITSTACK`       | 物品堆叠分离   |
| `PICKUPACTION`     | 拖动技能栏按钮 |
| `COMPAREITEMS`     | 物品比较       |
| `OPENALLBAGS`      | 打开所有背包   |
| `QUESTWATCHTOGGLE` | 任务追踪       |
